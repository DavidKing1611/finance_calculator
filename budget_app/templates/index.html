<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <title>Бюджетный калькулятор</title>
</head>
<body>
    <div class="container">
        <h1>Бюджетный калькулятор</h1>
        <form method="POST">
            <label for="income">Введите ваш месячный доход:</label>
            <input type="number" name="income" id="income" required>
            <label for="income_currency">Введите валюту дохода (например, RUB, USD, EUR):</label>
            <input type="text" name="income_currency" id="income_currency" required>
            <h2>Расходы</h2>
            <div id="expenses">
                <div class="expense">
                    <label for="category_0">Категория:</label>
                    <input type="text" name="category[]" id="category_0" required>
                    <label for="amount_0">Сумма:</label>
                    <input type="number" name="amount[]" id="amount_0" required>
                    <label for="currency_0">Валюта:</label>
                    <input type="text" name="currency[]" id="currency_0" required>
                </div>
            </div>
            <button type="button" onclick="addExpense()">Добавить расход</button>
            <h2>Цель</h2>
            <label for="goal_amount">Введите сумму для накопления:</label>
            <input type="number" name="goal_amount" id="goal_amount" required>
            <label for="goal_currency">Введите валюту для накопления (например, RUB, USD, EUR):</label>
            <input type="text" name="goal_currency" id="goal_currency" required>
            <label for="goal_months">Введите количество месяцев для накопления:</label>
            <input type="number" name="goal_months" id="goal_months" required>
            <button type="submit">Сохранить</button>
        </form>

        <h2>Калькулятор</h2>
        <div id="calculator">
            <input type="text" id="calcInput" placeholder="Введите выражение" />
            <button onclick="calculate()">=</button>
            <button onclick="clearCalc()">C</button>
        </div>
        <div id="calcResult"></div>

        <h2>Дополнительные инструменты</h2>
        <a href="{{ url_for('loan_calculator') }}">Калькулятор кредитов и займов</a>
    </div>
    <script>
        let expenseCount = 1; // Счетчик расходов для уникальных id
        function addExpense() {
            const expenseDiv = document.createElement('div');
            expenseDiv.className = 'expense';
            expenseDiv.innerHTML = `
                <label for="category_${expenseCount}">Категория:</label>
                <input type="text" name="category[]" id="category_${expenseCount}" required>
                <label for="amount_${expenseCount}">Сумма:</label>
                <input type="number" name="amount[]" id="amount_${expenseCount}" required>
                <label for="currency_${expenseCount}">Валюта:</label>
                <input type="text" name="currency[]" id="currency_${expenseCount}" required>
            `;
            document.getElementById('expenses').appendChild(expenseDiv);
            expenseCount++;
        }

        function calculate() {
            const input = document.getElementById('calcInput').value;
            try {
                const result = eval(input);
                document.getElementById('calcResult').innerText = `Результат: ${result}`;
            } catch (e) {
                document.getElementById('calcResult').innerText = 'Ошибка в выражении';
            }
        }

        function clearCalc() {
            document.getElementById('calcInput').value = '';
            document.getElementById('calcResult').innerText = '';
        }
    </script>
</body>
</html>

